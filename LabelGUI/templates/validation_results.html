<!DOCTYPE html>
<html>
<head>
    <title>Validation - Mark Events</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1>Video Stream - Mark Events</h1>

    <!-- Video feed -->
    <img src="{{ url_for('validation_video_feed') }}" width="800">

    <br><br>
    <!-- Playback controls -->
    <button onclick="rewind()">&laquo; Rewind 10s</button>
    <button onclick="togglePause()">Pause/Resume</button>
    <button onclick="forward()">Forward 10s &raquo;</button>

    <br><br>
    <!-- Event buttons -->
    <h2>Mark Events</h2>
    <button onclick="markEvent('takeoff')">Mark Take-off</button>
    <button onclick="markEvent('land')">Mark Land</button>
    <button onclick="markEvent('minor-crash')">Mark Minor Crash</button>
    <button onclick="markEvent('severe-crash')">Mark Severe Crash</button>

    <p>Total Events Observed: <span id="eventCount">0</span></p>

    <br>
    <a href="/"><button type="button">Back to Home</button></a>
</div>

<script>
function markEvent(eventType) {
    fetch('/mark_event', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ event: eventType })
    }).then(() => updateCount());
}

function updateCount() {
    fetch('/get_crash_count')
        .then(r => r.text())
        .then(txt => { document.getElementById("eventCount").innerText = txt; });
}

function rewind() { fetch('/rewind', { method: 'POST' }); }
function forward() { fetch('/fast_forward', { method: 'POST' }); }
function togglePause() { fetch('/toggle_pause', { method: 'POST' }); }

// Refresh count every few seconds
setInterval(updateCount, 2000);
</script>
</body>
</html>
